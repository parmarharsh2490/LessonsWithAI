<div class="flex flex-col rounded-lg w-full ms-2">
  <div
    class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2 sm:gap-0 py-2 sm:py-0 px-3 sm:px-4"
  >
    <h3
      class="font-bold text-xl sm:text-2xl lg:text-3xl text-primary mb-2 sm:mb-3 pb-2 border-b border-primary/20"
    >
      {{ pageHeader() }}
    </h3>
    @if (showAdd()) {
      <p-button
        label="Add"
        (onClick)="handleAdd()"
        icon="pi pi-plus"
        [size]="'small'"
      />
    }
  </div>
  <div class="p-2 sm:p-4 h-100">
    <div class="rounded-lg shadow-sm">
      <p-table
        [value]="dataList() || []"
        [paginator]="true"
        [rows]="pageSize() || 10"
        [totalRecords]="totalRecords() || 0"
        [rowsPerPageOptions]="[10, 20, 30]"
        [scrollable]="true"
        [scrollHeight]="'calc(100vh - 300px)'"
        [tableStyle]="{ width: '100%', minWidth: '600px' }"
        [responsiveLayout]="'stack'"
      >
        <ng-template pTemplate="header">
          <tr>
            @for (header of headerList(); track header) {
              <th
                class="font-semibold text-sm tracking-wide py-4 px-3 border-b-2 border-primary-300 border-r border-primary-200 last:border-r-0"
              >
                {{ header.label }}
              </th>
            }
            @if (showEdit()) {
              <th
                class="font-semibold text-sm tracking-wide py-4 px-3 border-b-2 border-primary-300 border-r border-primary-200 last:border-r-0 text-center"
              >
                Edit
              </th>
            }
            @if (showDelete()) {
              <th
                class="font-semibold text-sm tracking-wide py-4 px-3 border-b-2 border-primary-300 border-r border-primary-200 last:border-r-0 text-center"
              >
                Delete
              </th>
            }
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-data>
          <tr
            class="transition-all duration-200 ease-in-out border-b border-black/6 hover:bg-primary-50 hover:-translate-y-0.5 hover:shadow-sm last:border-b-0"
          >
            @for (header of headerList(); track header; let i = $index) {
              @if (header.type === "date") {
                <td
                  (click)="onRowClick.emit(data)"
                  [class]="
                    isRowClick()
                      ? 'cursor-pointer py-4 px-3 text-sm text-gray-700 align-middle border-r border-black/4 last:border-r-0'
                      : 'py-4 px-3 text-sm text-gray-700 align-middle border-r border-black/4 last:border-r-0 cursor-default'
                  "
                  [class.font-bold]="$index == 0"
                >
                  {{ data[header.key] | date: "dd/MM/yyyy" }}
                </td>
              } @else {
                @if (header.hyperlink) {
                  <td
                    (click)="
                      onChange.emit({
                        data: data,
                        event: { type: 'hyperlink', key: header.key },
                      })
                    "
                    class="cursor-pointer underline py-4 px-3 text-sm text-gray-700 align-middle border-r border-black/4 last:border-r-0 text-primary-600 hover:text-primary-700"
                    [class.font-bold]="$index == 0"
                  >
                    {{ data[header.key] }}
                  </td>
                } @else {
                  <td
                    (click)="onRowClick.emit(data)"
                    [class]="
                      isRowClick()
                        ? 'cursor-pointer py-4 px-3 text-sm text-gray-700 align-middle border-r border-black/4 last:border-r-0'
                        : 'py-4 px-3 text-sm text-gray-700 align-middle border-r border-black/4 last:border-r-0 cursor-default'
                    "
                    [class.font-bold]="$index === 0"
                    [class.text-primary-500]="$index === 0"
                  >
                    {{ data[header.key] }}
                  </td>
                }
              }
            }
            @if (showEdit()) {
              <td
                (click)="handleEdit(data)"
                class="cursor-pointer py-4 px-3 text-sm text-gray-700 align-middle border-r border-black/4 last:border-r-0 text-center"
              >
                <i
                  class="pi pi-pencil text-primary-500 hover:text-primary-700 transition-colors"
                ></i>
              </td>
            }
            @if (showDelete()) {
              <td
                (click)="handleDelete(data)"
                class="cursor-pointer py-4 px-3 text-sm text-gray-700 align-middle border-r border-black/4 last:border-r-0 text-center"
              >
                <i
                  class="pi pi-trash text-red-500 hover:text-red-700 transition-colors"
                ></i>
              </td>
            }
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
<p-confirmdialog />
